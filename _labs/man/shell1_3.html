<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Transitional//EN">
<HTML>
<HEAD>
   <meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
   <meta name="Author" content="NPO KLOTO">
   <meta name="Generator" content="Far Editor">
   <meta name="Description" content="Unix">
   <meta name="Keywords" content="unix, shell">
   <title> Интерпретатор командного языка shell 3.</title>
<!--                                                                   -->
</head>

<body background=../iip_1.jpg>
<p>
<table cellpadding=10>
<tr><td><a href=mind.html>Список команд</a></td></tr>
</table>
<table cellpadding=10>
<tr><td><a href=shell1_2.html>Назад</a></td><td><a href=shindex.html>Оглавление</a></td><td><a href=shell1_4.html>Вперед</a></td></tr>
</table>
</p>
<hr>
<a name=3></a>
<h3 align=center>3. Управляющие конструкции </h3>
<p align=justify>Простая команда - это последовательность слов, разделенная пробелами. Первое слово является именем команды, которая  будет выполняться, а остальные будут переданы ей как  аргументы.  Имя команды передается ей как аргумент номер 0  (т.е.  имя  команды является значением $0). Значение, возвращаемое простой командой - это ее статус завершения, если она завершилась нормально, или (восьмеричное) 200+статус, если она завершилась аварийно.
<p align=justify>Список - это последовательность одного или нескольких  конвейеров, разделенных символами ;, &, && или || и быть может заканчивающаяся символом ; или &. Из четырех указанных операций ; и & имеют равные приоритеты, меньшие, чем у && и ||. Приоритеты последних также равны между собой. Символ ; означает, что  конвейеры будут выполняться последовательно, а  &  -  параллельно. Операция && (||) означает, что список, следующий за  ней  будет выполняться лишь в том случае, если код завершения  предыдущего конвейера нулевой (ненулевой).
<p align=justify>Команда - это либо простая команда, либо одна из управляющих конструкций. Кодом завершения команды является код завершения ее последней простой команды.
<a name=3_1></a>
<h4> 3.1. Цикл ДЛЯ</h4>
<pre>
        for &lt;переменная> [ in &lt;набор> ]
        do
        &lt;список>
        done
</pre>
<p align=justify>Если часть in &lt;набор> опущена, то это означает  in  "$@"  (  то есть in $1 $2 ... $n). Пример. Вывести на экран все  фортранные файлы текущей библиотеки:
<pre>
        for f in *.for
        do
        cat $f
        done
</pre>
<a name=3_2></a>
<h4> 3.2. Оператор выбора</h4>
<pre>
        case $&lt;переменная> in
                &lt;шаблон> | &lt;шаблон>... ) &lt;список> ;;
                . . .
        esac
</pre>
<p align=justify>Оператор выбора  выполняет  &lt;список>,  соответствующий  первому &lt;шаблону>, которому удовлетворяет &lt;переменная>.  Форма  шаблона та же, что и  используемая  для  генерации  имен файлов.  Часть | шаблон... может отсутствовать.
<p align=justify>Пример. Определить флаги и откомпилировать все указанные файлы.
<pre>
#       инициализировать флаг
flag=
#       повторять для каждого аргумента
for a
do
        case $a in
                # об(r)единить флаги, разделив их пробелами
                -[ocSO]) flag=$flag' ' $a ;;
                     -*) echo 'unknown flag $a' ;;
                # компилировать каждый исходный файл и сбросить флаги
                    *.c) cc $flag $a; flag= ;;
                    *.s) as $flag $a; flag= ;;
                    *.f) f77 $flag $a; flag= ;;
                # неверный аргумент
                      *) echo 'unexpected argument $a' ;;
        esac
done
</pre>
<a name=3_3></a>
<h4> 3.3. Условный оператор.</h4>
<pre>
        if &lt;список1>
        then
        &lt;список2>
      [ elif &lt;список3>
        then
        &lt;список4> ]
        . . .
      [ else
        &lt;список5> ]
        fi
</pre>
<p align=justify>Выполняется &lt;список1> и, если код его завершения 0, то выполняется &lt;список2>, иначе - &lt;список3> и, если и его код  завершения 0, то выполняется &lt;список4>. Если же это не так, то выполняется &lt;список5>. Части elif и else могут отсутствовать.
<a name=3_4></a>
<h4> 3.4. Цикл ПОКА</h4>
<pre>
        while &lt;список1>
        do
        &lt;список2>
        done
</pre>
<p align=justify>До тех пор, пока код  завершения  последней  команды  &lt;списка1> есть 0, выполняются команды &lt;списка2>. При замене служебного слова while на until условие  выхода из цикла меняется на противоположное.
<p align=justify>В качестве одной из команд &lt;списка1>  может  быть  команда true (false). По этой команде не выполняется никаких  действий, а код завершения устанавливается 0 (-1). Эти команды применяются для организации бесконечных циклов. Выход  из  такого  цикла можно осуществить лишь по команде break (см. Специальные команды).
<a name=3_5></a>
<h4> 3.5. Функции</h4>
<pre>
        &lt;имя> () {
                  &lt;список>;
                 }
</pre>
<p align=justify>Определяется функция с именем &lt;имя>. Тело функции  -  &lt;список>, заключенный между { и }.
<a name=3_6></a>
<h4> 3.6. Зарезервированные слова</h4>
<p align=justify>     Следующие слова являются зарезервированными:
<pre>
   if      then    else    elif    fi
   case    in      esac    { }
   for     while   until   do      done
</pre>
<a name=3_7></a>
<h4> 3.7. Специальные команды</h4>
<p align=justify>Как правило, для выполнения каждой команды shell порождает отдельный процесс. Специальные команды отличаются тем, что  они встроены в shell и выполняются в рамках текущего процесса.
<p><table border=0 width=100%>
<tr valign=top><td>: <td colspan=2>  Пустая команда. Возвращает нулевой код завершения.
<tr valign=top><td>. file  <td colspan=2>Shell читает и выполняет команды из файла file,         затем завершается; при поиске file используется  список поиска $PATH.
<tr valign=top><td>break [n] <td colspan=2>Выход из внутреннего for или while цикла;  если  указано n, то выход из n внутренних циклов.
<tr valign=top><td>continue [n] <td colspan=2>Перейти к следующей  итерации  внутреннего  for   или while цикла; если указано n, то  переход  к   следующей итерации n-ого цикла.
<tr valign=top><td>cd [ &lt;аргумент> ] <td colspan=2>Сменить текущую директорию на директорию &lt;аргумент>. По умолчанию используется значение HOME.
<tr valign=top><td>echo [ &lt;арг> ... ] <td colspan=2>Выводит свои  аргументы  в  стандартный  вывод,   разделяя их пробелами.
<tr valign=top><td>eval [ &lt;арг> ... ] <td colspan=2>  Аргументы читаются, как если бы  они  поступали  из стандартного ввода и рассматриваются как команды, которые тут же и выполняются.
<tr valign=top><td>exec [ &lt;арг> ... ] <td colspan=2>  Аргументы рассматриваются как команды shell'а  и тут же выполняются, но при  этом  не  создается   нового процесса. В  качестве  аргументов  могут    быть указаны направления ввода-вывода  и,  если  нет никаких других аргументов, то будет изменено лишь направление ввода-вывода текущей  программы.
<tr valign=top><td>exit [ n ] <td colspan=2>  Завершение выполнения shell'а с кодом завершения  n. Если n опущено, то  кодом  завершения  будет  код завершения  последней  выполненной  команды (конец файла также приводит к завершению выполнения).
<tr valign=top><td>export [ &lt;переменная> ... ] <td colspan=2>Данные переменные отмечаются для автоматического экспорта в окружение (см. Окружение)  выполняемых команд. Если аргументы  не  указаны,  то   выводится список всех  экспортируемых  переменных. Имена функций не могут экспортироваться.
<tr valign=top><td>hash [ -r ] [ &lt;команда> ... ] <td colspan=2>  Для каждой  из  указанных  команд  определяется    и запоминается путь поиска.  Опция  -r  удаляет     все запомненные данные. Если не указан ни  один    аргумент, то выводится информация о запомненных   командах: hits - количество обращений shell'а  к  данной команде; cost - объем работы для обнаружения команды в списке поиска; command - полное   имя команды. В некоторых  ситуациях  происходит перевычисление запомненных данных, что  отмечается значком * в поле hits.
<tr valign=top><td>pwd  <td>  Выводит имя текущей директории.
<tr valign=top><td>read [ &lt;переменная> ... ] <td colspan=2>     Читается  из  стандартного  ввода одна  строка;    первое ее слово присваивается  первой  переменной, второе - второй и т.д., причем все  оставшиеся слова  присваиваются  последней  переменной.
<tr valign=top><td>readonly [ &lt;переменная> ... ] <td colspan=2>Запрещается изменение значений указанных  переменных. Если аргумент не указан , то  выводится  информация обо всех переменных типа readonly.
<tr valign=top><td>return [ n ] <td>  Выход из функции с кодом завершения n.  Если  n   опущено, то кодом завершения будет код завершения последней выполненной команды.
<tr valign=top><td>set [ --aefkntuvx [ &lt;арг> ... ] ] <td colspan=2>   Команда устанавливает следующие режимы:
<tr valign=top><td>   -a <td>  отметить переменные, которые были изменены  или  созданы, как переменные окружения (см.  Окружение)
<tr valign=top><td>   -e  <td>    если код завершения команды ненулевой,  то  немедленно завершить выполнение shell'а
<tr valign=top><td>   -f <td>  запретить генерацию имен файлов
<tr valign=top><td>   -k  <td>  все переменные с именем помещаются в  окружение   команды, а не только те, что предшествуют имени  команды (см. Окружение)
<tr valign=top><td>   -n  <td>  читать команды, но не выполнять их
<tr valign=top><td>   -t   <td>   завершение shell'а после ввода и выполнения  одной команды
<tr valign=top><td>  -u  <td>  при подстановке  рассматривать  неустановленные  переменные как ошибки
<tr valign=top><td>   -v  <td>  вывести вводимые строки сразу после их ввода
<tr valign=top><td>   -x  <td>  вывести команды и их аргументы перед их  выполнением
<tr valign=top><td>   --  <td>  не изменяет флаги, полезен для присваивания позиционным переменным новых значений.
<tr><td><td colspan=2>  При указании + вместо - каждый из флагов  устанавливает противоположный режим. Набор  текущих  флагов есть значение переменной $-. &lt;арг> - это   значения, которые будут  присвоены  позиционным    переменным $1, $2 и  т.д.  Если  все  аргументы  опущены, выводятся значения всех переменных.
<tr valign=top><td>shift [ n ] <td colspan=2>   Позиционные переменные, начиная с $(n+1), переименовываются в $1 и т.д. По умолчанию n=1.
<tr valign=top><td>test  <td colspan=2>   вычисляет условные выражения (см.  Дополнительные сведения. Test )
<tr valign=top><td>trap [ &lt;арг> ] [ n ] ... <td colspan=2>   Команда &lt;арг> будет выполнена, когда shell  получит сигнал n (см. Сигналы).  (Надо  заметить,     что &lt;арг> проверяется при установке  прерывания   и при получении сигнала).  Команды  выполняются   по порядку номеров сигналов. Любая попытка  установить сигнал, игнорируемый данным процессом,  не обрабатывается. Попытка прерывания по сигналу 11 (segmentation violation) приводит к ошибке. Если &lt;арг> опущен, то все прерывания  устанавливаются в их начальные значения. Если &lt;арг>     есть пустая строка, то этот сигнал игнорируется    shell'ом и вызываемыми им программами. Если n=0,    то &lt;арг> выполняется при выходе из shell'а. Trap   без аргументов выводит список команд, связанных   с каждым сигналом.
<tr valign=top><td>type [ &lt;имя> ... ] <td colspan=2>     Для каждого имени показывает, как оно будет интерпретироваться при использовании  в  качестве     имени команды: как внутренняя  команда  shell'а,  как имя файла или же такого файла нет вообще.
<tr valign=top><td>ulimit [ -f ] [ n ] <td colspan=2>    Устанавливает размер файла в n блоков; -f - устанавливает размер файла,  который  может  быть      записан процессом-потомком (читать можно  любые    файлы). Без аргументов - выводит  текущий  размер.
<tr valign=top><td>umask [ nnn ] <td colspan=2>  Пользовательская маска создания файлов  изменяется на nnn. Если nnn опущено, то выводится текущее значение маски. Пример: после команды   umask 755   будут создаваться файлы, которые владелец  сможет читать, писать и выполнять, а все остальные  - только читать и выполнять.
<tr valign=top><td>unset [ &lt;имя> ... ] <td colspan=2>     Для каждого имени удаляет соответствующую переменную или функцию. Переменные PATH, PS1, PS2 и  IFS не могут быть удалены.
<tr valign=top><td>wait [ n ] <td colspan=2>   Ждет завершения указанного процесса  и  выводит   код его завершения. Если n не указано, то  ожидается завершения всех  активных  процессов-потомков и возвращается код завершения 0.
</table>
<p><hr>
<table cellpadding=10>
<tr><td><a href=shell1_2.html>Назад</a></td><td><a href=shindex.html>Оглавление</a></td><td><a href=shell1_4.html>Вперед</a></td></tr>
</table>
<table cellpadding=10>
<tr><td><a href=mind.html>Список команд</a></td></tr>
</p>
</body>
</html>
