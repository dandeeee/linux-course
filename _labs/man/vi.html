<html>
   <meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
   <TITLE> VI command.</TITLE>
</head>
<body background=../iip_1.jpg>

<H2 align=center>Pедактор VI</H2>
<P>В процессе работы в системе вам необходимо будет создавать и редактировать 
   текстовые файлы. Все эти действия можно выполнить с помощью экранного 
   текстового редактора <samp>vi</samp>.</P>
<P>Для начала попробуем создать новый файл, например <samp>'testvi'</samp>:</P>
<PRE>$ vi testvi</PRE>
<P>Появится пустой экран с курсором в первой строке. Остальные строки (также 
   пустые) будут начинаться с символа <samp>'~'</samp> (тильда). В самой 
   последней строке будет сообщение примерно такого содержания:</P>
<PRE>
testvi: new file: line 1.
</PRE>
<P>В дальнейшем эта строка будет также использоваться и для ввода команд.</P>
<P>Немного отвлечемся от нашего файла и рассмотрим систему команд 
   <samp>vi</samp>. Большинство команд - это одиночные клавиши или комбинации 
   клавиш, которые выполняют простые функции редактирования. <samp>vi</samp> 
   работает в двух основных режимах - в режиме <samp>"ввода текста"</samp> и в 
   режиме <samp>"команд"</samp>.</P>
<P>После запуска <samp>vi</samp> оказывается в режиме <samp>"команд"</samp>. 
   Для перехода в режим <samp>"ввода текста"</samp> необходимо нажать на 
   клавишу <samp>'a'</samp> или <samp>'i'</samp> (обращайте внимание на регистр 
   клавиш!). После этого можно набирать текст. Каждую введенную строку следует, 
   как это принято, завершать нажатием клавиши <samp>[Enter]</samp>.</P>
<P>Выполните следующие действия. Нажмите клавишу <samp>'a'</samp>, перейдите 
   в режим <samp>"ввода текста"</samp> и наберите 3 строки:</P>
<PRE>
Line 1Line 2
Line 3
</PRE>
<P>Для перехода в режим <samp>"команд"</samp> нажмите на клавишу 
   <samp>Esc</samp>. Эта же клавиша используется для отмены не до конца 
   набранной команды. Если вы неправильно ввели команду, редактор сообщит об 
   этом одиночным звуковым сигналом.</P><P>Допустим, вам необходимо вставить в начало второй строки еще одно слово. 
   Для этого в режиме <samp>"команд"</samp> перейдите куpсоpом на нужную 
   строку, установите курсор в первую позицию и нажмите клавишу 
   <samp>'i'</samp>. После этого вставьте нужный текст, например слово 
   <samp>'Insert'</samp>:</P>
<PRE>
Line 1Insert Line 2
Line 3
</PRE>
<P>Для перехода в режим <samp>"команд"</samp> снова нажмите клавишу 
   <samp>'Esc'</samp>, назначение которой надеемся вы уже поняли. Если вы по 
   каким-то причинам запутались в каком режиме вы находитесь, нажмите два раза 
   подряд <samp>Esc</samp>. Редактор выдаст звуковой сигнал, сообщая таким 
   образом, что вы находитесь в режиме <samp>"команд"</samp>.</P>
<P>Чтобы сделать редактор немного по разговорчивей, в режиме 
   <samp>"команд"</samp> введите следующую команду в нижней строке:</P>
<PRE>
:set verbose showmmode [Enter]
</PRE>
<P>(В данном примере символ <samp>':'</samp> означает признак ввода команды.)</P>
<P>После выполнения данной команды редактор будет вам сообщать о достижении 
   конца строки и файла, переходе в режим <samp>"команд"</samp> и т.д.</P>
<P>Для перемещения курсора по тексту в режиме <samp>"команд"</samp> можно 
   использовать клавиши управления курсором, а также следующие клавиши:</P>
<TABLE BORDER=1 align=center>
  <TR>
    <TD align=center valign=top><samp>h</samp><br>или<br><samp>ПРОБЕЛ</samp></TD>
    <TD>&nbsp;Курсор на один символ влево.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>l</samp><br>или<br><samp>&nbsp;BACKSPASE&nbsp;</samp></TD>
    <TD>&nbsp;Курсор на один символ вправо.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp></samp>j</TD>
    <TD>&nbsp;Курсор вниз на одну строку.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>k</samp></TD>
    <TD>&nbsp;Курсор вверх на одну строку.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>^</samp></TD>
    <TD>&nbsp;Переместить курсор на начало первого слова текущей строки.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>$</samp></TD>
    <TD>&nbsp;Переместить курсор в конец текущей строки.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>|</samp></TD>
    <TD>&nbsp;Переместить курсор в первую позицию текущей строки.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>w</samp></TD>
    <TD>&nbsp;Переместить курсор вперед на начало следующего cлова.</TD>
  </TR>
  <TR>
    <TD align=center valign=top align=center valign=top><samp>b</samp></TD>
    <TD>&nbsp;Переместить курсор назад на начало текущего слова.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>e</samp></TD>
    <TD>&nbsp;Переместить курсор в конец слова.</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>(</samp></TD>
    <TD>&nbsp;Переместить курсор в начало предложения (назад).</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>)</samp></TD>
    <TD>&nbsp;Переместить курсор в конец предложения (вперед).</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>{</samp></TD>
    <TD>&nbsp;Переместить курсор на начало параграфа (назад).</TD>
  </TR>
  <TR>
    <TD align=center valign=top><samp>}</samp></TD>
    <TD>&nbsp;Переместить курсор в конец параграфа (вперед). (Параграфы могут быть 
        разделены пустыми строками).</TD>
  </TR>
</TABLE></p>
<P>Если перед нажатием на клавишу набрать какое-либо число, то курсор будет перемещен на соответствующее число позиций или строк.</P>
<p><TABLE BORDER=1 align=center>
  <TR>
    <TD>&nbsp;<samp><i>число</i>ПРОБЕЛ</samp></TD>
    <TD>&nbsp;Переместить курсор на указанное <samp><i>число</i></samp> позиций вправо.</TD>
  </TR>
  <TR>
    <TD>&nbsp;<samp><i>число</i>BACKSPASE</samp></TD>
    <TD>&nbsp;Переместить курсор на указанное <samp><i>число</i></samp> позиций влево.</TD>
  </TR>
</TABLE></p>
<P>Также для пеpемещения по тексту можно использовать следующие команды:</P>
<p><TABLE BORDER=1 align=center>
  <TR>
    <TD>&nbsp;<samp><i>число</i>G&nbsp;</samp></TD>
    <TD>&nbsp;Переместить курсор в указанную строку.</TD>
  </TR>
  <TR>
    <TD>&nbsp;<samp><i>число</i>|&nbsp;</samp></TD>
    <TD>&nbsp;Переместить курсор в указанную позицию текущей строки.</TD>
  </TR>
</TABLE></p>
<P>В данном случае <samp><i>число</i></samp> обозначает количество повторов команды, которое необходимо выполнить.</P>
<P>Для поиска текста можно использовать команду <samp>'/'</samp>. После нее необходимо ввести строку для поиска и нажать <samp>[Enter]</samp>. Например:</P>
<PRE>
:/Line 5[Enter]
</PRE>
<P>После завершения поиска курсор будет находиться на первом символе строки.</P>
<P>Знак вопроса <samp>'?'</samp> работает так же, только поиск в файле ведется назад (т.е. в обратном направлении)</P>
<P>Для перехода в режим <samp>"ввода текста"</samp> можно использовать следующие команды:</P>
<p><TABLE BORDER=1 align=center>
  <TR>
    <TD>&nbsp;<samp>a</samp>&nbsp;</TD>
    <TD>&nbsp;Вставить текст после курсора.</TD>
  </TR>
  <TR>
    <TD>&nbsp;<samp>i</samp>&nbsp;</TD>
    <TD>&nbsp;Вставить текст перед курсором.</TD>
  </TR>
  <TR>
    <TD>&nbsp;<samp>o</samp>&nbsp;</TD>
    <TD>&nbsp;Вставить новую строку после текущей.</TD>
  </TR>
  <TR>
    <TD>&nbsp;<samp>O</samp>&nbsp;</TD>
    <TD>&nbsp;Вставить новую строку перед текущей.</TD>
  </TR>
</TABLE></P>
<P>(Текущей будем называть строку в которой расположен курсор, а текущим символом - символ в котором находится курсор).</P>
<P>В режиме команд можно выполнять редактирование набранного текста с помощью следующих команд:</P>
<p><TABLE BORDER=1 align=center>
  <TR>
    <TD align=center>&nbsp;<samp>x</samp></TD>
    <TD>&nbsp;Удалить текущий символ.</TD></TR>
  <TR>
    <TD align=center>&nbsp;<samp>dd</samp>&nbsp;</TD>
    <TD>&nbsp;Удалить текущую строку.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp><i>число</i>dd</samp>&nbsp;</TD>
    <TD>&nbsp;Удалить указанное <samp><i>число</i></samp> строк начиная 
        с текущей.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>dw</samp>&nbsp;</TD>
    <TD>&nbsp;Удалить текущее слово.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp><i>число</i>dw</samp>&nbsp;</TD>
    <TD>&nbsp;Удалить указанное <samp><i>число</i></samp> слов начиная с текущего.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>r</samp>&nbsp;</TD>
    <TD>&nbsp;Заменить текущий символ на символ, набранный вслед за <samp>'r'</samp>.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp><i>число</i>s</samp>&nbsp;</TD>
    <TD>&nbsp;Заменить указанное <samp><i>число</i></samp> символов на такое же <samp>'число'</samp> набранных вслед символов.</TD>
  </TR>
</TABLE></P>

<P>Вообще-то последний удаленный фрагмент текста не теряется, а сохраняется в 
   специальном буфере и может быть оперативно (сразу после удаления) 
   восстановлен и вставлен в любое место файла. Такую возможность можно 
   использовать для переноса строк из одного места в другое. Например, вам 
   необходимо поменять местами строки 3 и 2 нашего файла.</P>
<P>Для этого перейдите в режим <samp>"команд"</samp> (<samp>Esc</samp>), 
   установите курсор во вторую строку, введите комбинацию <samp>'dd</samp>. 
   Строка <samp>'Line 2'</samp> будет удалена (помещена в буфер), и весь 
   текст сдвинется вверх. В текущей строке появится строка <samp>'Line 3'</samp>:</P>
<PRE>
Line 1
Line 3
</PRE>
<P>Далее нажмите клавишу <samp>'p'</samp>. После текущей строки 
   (<samp>'Line 3'</samp>) из буфера будет восстановлена и станет текущей 
   строка <samp>'Line 2'</samp>:</P>
<PRE>
Line 1
Line 3
Line 2
</PRE>
<P>Соответственно для вставки удаленной строки перед текущей можно 
   использовать команду <samp>'P'</samp>.</P>
<P>Если вам необходимо сохранить в буфере строку без ее удаления, используйте 
   команду <samp>'yy'</samp>. В дальнейшем эту строку можно скопировать в 
   другое место файла. Для работы с буфером и для перемещения (копирования) 
   строк можно использовать следующие команды:</P>
<P><TABLE BORDER=1 align=center>
  <TR>
    <TD align=center>&nbsp;<samp>yw</samp>&nbsp;</TD>
    <TD>&nbsp;Сохранить слово в буфере.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp><i>число</i>yw</samp>&nbsp;</TD>
    <TD>&nbsp;Сохранить указанное <samp><i>число</i></samp> слов в буфере.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>yy</samp>&nbsp;</TD>
    <TD>&nbsp;Сохранить текущую строку в буфере.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp><i>число</i>yy</samp>&nbsp;</TD>
    <TD>&nbsp;Сохранить указанное <samp><i>число</i></samp> строк в буфере.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>p</samp>&nbsp;</TD>
    <TD>&nbsp;Скопировать и поместить информацию из буфера после текущей строки.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>P</samp>&nbsp;</TD>
    <TD>&nbsp;Скопировать и поместить информацию из буфера перед текущей строкой.</TD>
  </TR>
</TABLE></P>
<P>(После копирования информация из буфера не удаляется и ее можно использовать еще).</P>
<P>Существует еще одна интересная команда - <samp>'.'</samp> (точка). Она выполняет последнюю введенную команду. Например, если с помощью команды <samp>'dd'</samp> была удалена строка, то нажатие на клавишу <samp>'.'</samp> приведет к удалению следующей строки. Если строка была помещена в окно редактирования из буфера по команде <samp>'p'</samp>, то нажатие на <samp>'.'</samp> приведет к помещению в окно редактирования еще одной копии строки.</P>
<P>При запуске <samp>vi</samp> можно указать следующие параметры:</P>
<p><TABLE BORDER=1 align=center>
  <TR>
    <TD width=25% align=center>&nbsp;<samp>vi</samp>&nbsp;</TD>
    <TD>&nbsp;Редактирует временный файл, которому при сохранении текста 
        необходимо дать имя.</TD>
  </TR>
  <TR>
    <TD width=25% align=center>&nbsp;<samp>vi +45 file</samp>&nbsp;</TD>
    <TD>&nbsp;Переходит на строку с номером <samp>45</samp>.</TD>
  </TR>
  <TR>
    <TD width=25% align=center>&nbsp;<samp>vi +/word file</samp>&nbsp;</TD>
    <TD>&nbsp;Ищет первое вхождение слова <samp>'word'</samp></TD>
  </TR>
  <TR>
    <TD width=25% align=center>&nbsp;</samp>$vi -c <i>cmd</i></samp>&nbsp;</TD>
    <TD>&nbsp;Выполняет команду <samp><i>cmd</i></samp> немедленно после 
        начала сеанса редактирования.</TD>
  </TR>
  <TR>
    <TD width=25% align=center>&nbsp;<samp>$vi -r</samp>&nbsp;</TD>
    <TD>&nbsp;Восстанавливает указанные файлы, если пpоизошел аваpийный выход 
        из pедактоpа или внезапное завеpшение системы. Если файлы не 
        опpеделены, вывести список файлов, котоpые могут быть восстановлены.</TD>
  </TR>
</TABLE></P>
<P>Для выхода из редактора и сохранения текста используете следующие команды:</P>
<P><TABLE BORDER=1 align=center>
  <TR>
    <TD align=center>&nbsp;<samp>:w</samp>&nbsp;</TD>
    <TD>&nbsp;сохранить текст без выхода из редактора</TD>
  </TR>
  <TR>
    <TD width=25% align=center>&nbsp;<samp>:w <i>имя_файла</i></samp>&nbsp;</TD>
    <TD>&nbsp;Сохранить текст в указанном файле.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>:wq</samp><br>или<br><samp>:x</samp>&nbsp;</TD>
    <TD>&nbsp;Сохранить текст и выйти из редактора.</TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>:q&nbsp;</samp></TD>
    <TD>&nbsp;Выйти из редактора. Если файл был модифицирован, вам будет 
        предложено для выхода без сохранения использовать команду <samp>:q!</samp></TD>
  </TR>
  <TR>
    <TD align=center>&nbsp;<samp>:q!&nbsp;</samp></TD>
    <TD>&nbsp;Выйти из редактора без сохранения текста.</TD>
  </TR>
</TABLE></P>
<P>На самом деле <samp>vi</samp> работает с копией вашего файла, поэтому в 
   случае сбоя ваш исходный файл вряд ли пострадает.</P>
<p><hr>
<a href=mind.html#vi>Список команд</a>
</body>
</html>
</body>
</html>
